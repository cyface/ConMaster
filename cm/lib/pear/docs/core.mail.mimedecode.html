<HTML
><HEAD
><TITLE
>Mail_mimeDecode</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.73
"><LINK
REL="HOME"
TITLE="PEAR Manual"
HREF="index.html"><LINK
REL="UP"
TITLE="PEAR Mail: Mail handling functions"
HREF="core.mail.html"><LINK
REL="PREVIOUS"
TITLE="Mail_mimePart"
HREF="core.mail.mimepart.html"><LINK
REL="NEXT"
TITLE="Mail_RFC822"
HREF="core.mail.rfc822.html"><META
HTTP-EQUIV="Content-type"
CONTENT="text/html; charset=ISO-8859-1"></HEAD
><BODY
CLASS="refentry"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PEAR Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="core.mail.mimepart.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="core.mail.rfc822.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="core.mail.mimedecode"
>Mail_mimeDecode</A
></H1
><DIV
CLASS="refnamediv"
><A
NAME="AEN2773"
></A
>Mail_mimeDecode&nbsp;--&nbsp;work with MIME messages</DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.desc"
></A
><H2
>Description</H2
><P
>&#13;    <B
CLASS="classname"
>Mail_mimeDecode</B
> provides functions to process
    MIME message. It will take the input you give it and decode it into a 
    usable PHP data structure.
   </P
></DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.mail_mimedecode"
></A
><H2
>Mail_mimeDecode::Mail_mimeDecode()</H2
><DIV
CLASS="funcsynopsis"
><A
NAME="AEN2782"
></A
><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>Mail_mimeDecode <B
CLASS="function"
>Mail_mimeDecode</B
></CODE
> (string $input [, string $crlf = "\r\n"])</CODE
></P
><P
></P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimepart.mail_mimedecode.description"
></A
><H3
>Description</H3
><P
>&#13;     Returns a new instance of <B
CLASS="classname"
>Mail_mimeDecode</B
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.mail_mimedecode.parameter"
></A
><H3
>Parameter</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>string $input</I
></TT
> - 
        The message to decode.
       </P
></LI
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>string $crlf</I
></TT
> - 
        This specifies the correct line ending to use. Usually either 
        <TT
CLASS="parameter"
><I
>CRLF</I
></TT
> or just <TT
CLASS="parameter"
><I
>LF</I
></TT
>.
        This option can make the difference between 
        this class working and not. You're strongly recommended to 
        ensure you're email uses exclusively what this argument is 
        set to. Default is <TT
CLASS="parameter"
><I
>CRLF</I
></TT
>. 
       </P
></LI
></UL
>
    </P
></DIV
></DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.decode"
></A
><H2
>Mail_mime::decode()</H2
><DIV
CLASS="funcsynopsis"
><A
NAME="AEN2810"
></A
><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>array <B
CLASS="function"
>decode</B
></CODE
> (array $args)</CODE
></P
><P
></P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.decode.description"
></A
><H3
>Description</H3
><P
>&#13;     This function performs the decoding and returns a structure containing 
     the message data.
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.decode.parameter"
></A
><H3
>Parameter</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>array $args</I
></TT
> - 
        <P
></P
><UL
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>boolean $args['include_bodies']</I
></TT
> -
           Whether to include the bodies in the returned structure. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>boolean $args['decode_bodies']</I
></TT
> -
           Whether to decode the returned bodies.            
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>boolean $args['decode_headers']</I
></TT
> -
           Whether to decode the headers 
           (<A
HREF="http://www.faqs.org/rfcs/rfc2047.html"
TARGET="_top"
>RFC2047
           </A
>). 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $args['input']</I
></TT
> -
           If and only if called statically, this should be used to specify 
           the input to be decoded. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $args['crlf']</I
></TT
> -
           If and only if called statically, this should be used to specify 
           the line ending type. 
          </P
></LI
></UL
>
       </P
></LI
></UL
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.decode.return"
></A
><H3
>Return value</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>array</I
></TT
> - 
        <P
></P
><UL
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>array $return['headers']</I
></TT
> - 
           An associative array of the headers. The keys of the array
           are the header names (lowercased) whilst the values are the
           header values (original case). if there are multiple headers
           with the same name (eg. <TT
CLASS="parameter"
><I
>Recieved:</I
></TT
> ) 
           then the value is a
           numerically indexed array of each of the header values.
           If the parameter <TT
CLASS="parameter"
><I
>decode_headers</I
></TT
> 
           is specified as true, then
           the headers will be decoded (RFC2047).            
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return['ctype_primary']</I
></TT
> - 
           The first part of the content type (ie. before the forward slash).
           Eg. If the content type is 
           <TT
CLASS="parameter"
><I
>multipart/mixed</I
></TT
>, ctype_primary would
           be <TT
CLASS="parameter"
><I
>"multipart"</I
></TT
>. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return['ctype_secondary']</I
></TT
> - 
           The second part of the content type. Eg. If the content type is
           <TT
CLASS="parameter"
><I
>multipart/mixed</I
></TT
>, ctype_secondary would 
           be <TT
CLASS="parameter"
><I
>"mixed"</I
></TT
>. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>array $return['ctype_parameter']</I
></TT
> - 
           If the content type header has any parameters 
           (eg. <TT
CLASS="parameter"
><I
>boundary="=_hudfhdsalfhds8fy8329hfj</I
></TT
>")
           then 
           they will be in this associative array. Keys are the parameter
           name (eg. <TT
CLASS="parameter"
><I
>boundary</I
></TT
>) whilst the values 
           are the parameter
           values (eg. =<TT
CLASS="parameter"
><I
>_hudfhdsalfhds8fy8329hfj</I
></TT
>). 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return['disposition']</I
></TT
> - 
           If the Content-Disposition header is present, it's value
           will be given here. This is usually either
           <TT
CLASS="parameter"
><I
>"inline"</I
></TT
> or
           <TT
CLASS="parameter"
><I
>"attachment"</I
></TT
>. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>array $return['d_parameters']</I
></TT
> - 
           If any parameters are given with the Content-Disposition header,
           they will be given here in an associative array, keys being the 
           parameter names and values being the parameter values. 
           <TT
CLASS="parameter"
><I
>"name"</I
></TT
> and <TT
CLASS="parameter"
><I
>"filename"</I
></TT
>
           are two common examples here. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>array $return['d_parameters']</I
></TT
> - 
           If any parameters are given with the Content-Disposition header,
           they will be given here in an associative array, keys being the 
           parameter names and values being the parameter values. 
           <TT
CLASS="parameter"
><I
>"name"</I
></TT
> and <TT
CLASS="parameter"
><I
>"filename"</I
></TT
>
           are two common examples here. 
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>array $return['body']</I
></TT
> - 
           If the <TT
CLASS="parameter"
><I
>include_bodies</I
></TT
> parameter is given 
           when instanciating the class, (either statically or normally), 
           then this will be present if the part in question has a body. 
           MIME parts with content type <TT
CLASS="parameter"
><I
>multipart/*</I
></TT
>
           generally do not not have bodies, instead consisting of 
           subparts. If the parameter <TT
CLASS="parameter"
><I
>decode_bodies</I
></TT
>
           is specified as <TT
CLASS="parameter"
><I
>true</I
></TT
> then the body will 
           be decoded. 
          </P
></LI
><LI
><P
>&#13;          <TT
CLASS="parameter"
><I
>array $return['parts']</I
></TT
> - 
          If a MIME part consists of subparts, then this array will be 
          present consisting of objects with the same properties as 
          described here. 
         </P
></LI
></UL
>
       </P
></LI
></UL
>
    </P
></DIV
></DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.uudecode"
></A
><H2
>Mail_mime::uudecode()</H2
><DIV
CLASS="funcsynopsis"
><A
NAME="AEN2899"
></A
><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>array <B
CLASS="function"
>uudecode</B
></CODE
> (string $input)</CODE
></P
><P
></P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.uudecode.description"
></A
><H3
>Description</H3
><P
>&#13;     <B
CLASS="function"
>uudecode()</B
> looks for UU-encoded parts in the 
     given message. <TT
CLASS="parameter"
><I
>UU</I
></TT
> stands for the <SPAN
CLASS="emphasis"
><I
CLASS="emphasis"
>&#13;     Unix-to-Unix</I
></SPAN
> protocol. Actually this is a common used
     protocoll for transfering files using the 7-bit-ASCII character set over
     the internet.
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.uudecode.parameter"
></A
><H3
>Parameter</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>string $input</I
></TT
> - 
        The message to decode.
       </P
></LI
></UL
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.uudecode.return"
></A
><H3
>Return value</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>array</I
></TT
> - 
        An array of associative arrays
        <P
></P
><UL
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return[]['filename']</I
></TT
> - 
           The name of the UUencoded file.
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return[]['fileperm']</I
></TT
> - 
            The file permissions of the UUencoded file, if given.
            The format is unix-styled, ie. <TT
CLASS="parameter"
><I
>"0666"</I
></TT
>
            or <TT
CLASS="parameter"
><I
>"666"</I
></TT
>.
          </P
></LI
><LI
><P
>&#13;           <TT
CLASS="parameter"
><I
>string $return[]['filedata']</I
></TT
> - 
           The decoded content of the UUencoded file.
          </P
></LI
></UL
>
       </P
></LI
></UL
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.uudecode.note"
></A
><H3
>Note</H3
><P
>&#13;     <B
CLASS="function"
>uudecode()</B
> can be called as static function.
    </P
></DIV
></DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.getxml"
></A
><H2
>Mail_mime::getXML()</H2
><DIV
CLASS="funcsynopsis"
><A
NAME="AEN2943"
></A
><P
></P
><P
><CODE
><CODE
CLASS="FUNCDEF"
>string <B
CLASS="function"
>getXML</B
></CODE
> (array $decoded)</CODE
></P
><P
></P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.getxml.description"
></A
><H3
>Description</H3
><P
>&#13;     <B
CLASS="function"
>getXML()</B
> converts the returned array from 
     <A
HREF="core.mail.mimedecode.html#core.mail.mimedecode.decode"
><B
CLASS="function"
>decode
     ()</B
></A
> into a valid XML document. The DTD for this 
     document is avaible from the Mail_MimeDecode-Package or 
     <A
HREF="http://www.phpguru.org/xmail/"
TARGET="_top"
>http://www.phpguru.org/xmail/
     </A
>.
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.getxml.parameter"
></A
><H3
>Parameter</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>array $decode</I
></TT
> - 
        The array from <A
HREF="core.mail.mimedecode.html#core.mail.mimedecode.decode"
>&#13;        <B
CLASS="function"
>decode()</B
></A
>.
       </P
></LI
></UL
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.getxml.return"
></A
><H3
>Return value</H3
><P
>&#13;     <P
></P
><UL
><LI
><P
>&#13;        <TT
CLASS="parameter"
><I
>string</I
></TT
> - 
        The XML document
       </P
></LI
></UL
>
    </P
></DIV
><DIV
CLASS="refsect2"
><A
NAME="core.mail.mimedecode.getxml.note"
></A
><H3
>Note</H3
><P
>&#13;     <B
CLASS="function"
>getXML()</B
> can be called as static function.
    </P
></DIV
></DIV
><DIV
CLASS="refsect1"
><A
NAME="core.mail.mimedecode.example"
></A
><H2
>Example</H2
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php

include 'Mail/mimeDecode.php';

...

$params['include_bodies'] = TRUE;
$params['decode_bodies']  = TRUE;
$params['decode_headers'] = TRUE;

$decoder = new Mail_mimeDecode($input);
$structure = $decoder-&#62;decode($params);

?&#62;</PRE
></TD
></TR
></TABLE
><P
>&#13;    This example calls the decode function statically (ie no object, 
    straight function call) and then passes the structure to the 
    <A
HREF="core.mail.mimedecode.html#core.mail.mimedecode.getxml"
><B
CLASS="function"
>getXML()</B
>
    </A
> function.
   </P
><TABLE
WIDTH="100%"
CELLSPACING="0"
CELLPADDING="0"
BORDER="0"
BGCOLOR="#EEEEEE"
><TR
><TD
><PRE
CLASS="php"
>&#60;?php

...

$params['include_bodies'] = TRUE;
$params['decode_bodies']  = FALSE;
$params['decode_headers'] = TRUE;
$params['input']          = $input;
$params['crlf']           = "\r\n";

$structure = Mail_mimeDecode::decode($params);
$xml = Mail_mimeDecode::getXML($structure);

?&#62;</PRE
></TD
></TR
></TABLE
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="core.mail.mimepart.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="core.mail.rfc822.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Mail_mimePart</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="core.mail.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Mail_RFC822</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>